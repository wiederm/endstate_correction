<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theory &mdash; endstate_correction  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> endstate_correction
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">endstate_correction</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Theory</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Permalink to this heading"></a></h1>
<p>## Equilibrium free energy endstate corrections
In equilibrium free energy calculations samples are drawn from the Boltzmann distrubtion
at specific interpolation states between thermodynamic states (in our specific case: different energetic
descriptions of the molecular system, i.e. the source level of theory and the target level of theroy) and,
given sufficient overlap of its pdfs, a free energy can be estimated. This protocol is expensive
(it needs iid samples at each lambda state connecting the Boltzmann distribution at the endstates)
but also reliable and accureate (with low variance).
![EQ](<a class="reference external" href="https://user-images.githubusercontent.com/64199149/183875892-239d53f0-4caf-4bd6-8f37-349448af7d01.PNG">https://user-images.githubusercontent.com/64199149/183875892-239d53f0-4caf-4bd6-8f37-349448af7d01.PNG</a>)</p>
<p>## Non-equilibrium work protocol
Non-equilibrium work protocols, and the fluctuation theorems connecting non-equilibrium driven
processes to equilibrium properties, can be used to estimate free energy differences between different</p>
<blockquote>
<div><p>levels of theory efficiently.</p>
</div></blockquote>
<dl class="simple">
<dt>A specific NEQ protocol typically consists of a series of perturbation kernel $alpha_t(x,y)$ and a</dt><dd><dl class="simple">
<dt>propagation kernel $kappa_t(x,y)$, which are used in an alternating pattern to drive the system</dt><dd><p>out of equilibrium.</p>
</dd>
</dl>
</dd>
</dl>
<p>Each perturbation kernel $alpha$ drives an alchemical coupling parameter $lambda$, and each
propagation kernel $kappa$ propagates the coordinates of the system at fixed $lambda$ according
to a defined MD process.
The free energy difference can then be recovered using either the Jarzynski equation (if initial conformations
to seed the NEQ protocol are only drawn from $pi(x, lambda=0)$ and the NEQ protocol perturbations only
from $lambda=0$ to $lambda=1$) or the Crooks’ fluctuation theorem (if samples to seed the NEQ protocol
are drawn from $pi(x, lambda=0)$ and $pi(x, lambda=1)$ and the perturbation kernels are set for a bidirectinoal
protocol).</p>
<p>## Free energy perturbation (FEP)</p>
<p>Here, we define FEP as a special case of the NEQ protocol (and the Jarzynski equation) in which the protocol
consists only of a single perturbation kernel $alpha_t(x,y)$, without a propagation kernel.</p>
<blockquote>
<div><p>$alpha_t(x,y)$ perturbates the alchemical DOF from one ‘endstate’, without any intermediate states,
to another ‘endstate’.</p>
</div></blockquote>
<p>In the limiting cases of infinitely fast switching the Jarzynski equality reduces to the well-known FEP equation:
$e^{-beta Delta F} = langle e^{−β[E(x,lambda=1)− E(x,lambda=0)]} rangle_{lambda=0}$.
$langle rangle_{lambda=0}$ indicate that samples are drawn from the equilibrium distribution $pi(x, lambda=0)$.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Marcus Wieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.6.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>