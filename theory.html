
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Equilibrium free energy endstate corrections &#8212; endstate_correction  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Documentation" href="api.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>Theory</p>
<section id="equilibrium-free-energy-endstate-corrections">
<h1>Equilibrium free energy endstate corrections<a class="headerlink" href="#equilibrium-free-energy-endstate-corrections" title="Permalink to this heading">¶</a></h1>
<p>In equilibrium free energy calculations samples are drawn from the Boltzmann distrubtion
at specific interpolation states between thermodynamic states (in our specific case: different energetic
descriptions of the molecular system, i.e. the source level of theory and the target level of theroy) and,
given sufficient overlap of its pdfs, a free energy can be estimated. This protocol is expensive
(it needs iid samples at each lambda state connecting the Boltzmann distribution at the endstates)
but also reliable and accureate (with low variance).</p>
<p><img alt="image" src="_images/equi.png" /></p>
</section>
<section id="non-equilibrium-work-protocol">
<h1>Non-equilibrium work protocol<a class="headerlink" href="#non-equilibrium-work-protocol" title="Permalink to this heading">¶</a></h1>
<p>Non-equilibrium work protocols, and the fluctuation theorems connecting non-equilibrium driven
processes to equilibrium properties, can be used to estimate free energy differences between different
levels of theory efficiently.
A specific NEQ protocol typically consists of a series of perturbation kernel .. math::\alpha_t(x,y)$ and a
propagation kernel $\kappa_t(x,y)$, which are used in an alternating pattern to drive the system
out of equilibrium.
Each perturbation kernel $\alpha$ drives an alchemical coupling parameter $\lambda$, and each
propagation kernel $\kappa$ propagates the coordinates of the system at fixed $\lambda$ according
to a defined MD process.
The free energy difference can then be recovered using either the Jarzynski equation (if initial conformations
to seed the NEQ protocol are only drawn from $\pi(x, \lambda=0)$ and the NEQ protocol perturbations only
from $\lambda=0$ to $\lambda=1$) or the Crooks’ fluctuation theorem (if samples to seed the NEQ protocol
are drawn from $\pi(x, \lambda=0)$ and $\pi(x, \lambda=1)$ and the perturbation kernels are set for a bidirectinoal
protocol).</p>
</section>
<section id="free-energy-perturbation-fep">
<h1>Free energy perturbation (FEP)<a class="headerlink" href="#free-energy-perturbation-fep" title="Permalink to this heading">¶</a></h1>
<p>Here, we define FEP as a special case of the NEQ protocol (and the Jarzynski equation) in which the protocol
consists only of a single perturbation kernel $\alpha_t(x,y)$, without a propagation kernel.
$\alpha_t(x,y)$ perturbates the alchemical DOF from one ‘endstate’, without any intermediate states,
to another ‘endstate’.
In the limiting cases of infinitely fast switching the Jarzynski equality reduces to the well-known FEP equation:
$e^{-\beta \Delta F} = \langle e^{−β[E(x,\lambda=1)− E(x,\lambda=0)]} \rangle_{\lambda=0}$.
$\langle \rangle_{\lambda=0}$ indicate that samples are drawn from the equilibrium distribution $\pi(x, \lambda=0)$.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">endstate_correction</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#how-to-use-this-package">How to use this package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Equilibrium free energy endstate corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="#non-equilibrium-work-protocol">Non-equilibrium work protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="#free-energy-perturbation-fep">Free energy perturbation (FEP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="getting_started.html" title="previous chapter">Getting Started</a></li>
      <li>Next: <a href="api.html" title="next chapter">API Documentation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Marcus Wieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.6.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/theory.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>